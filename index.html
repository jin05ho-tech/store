<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>평가 점수 확률 계산기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            text-align: center;
            color: #444;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input {
            width: calc(100% - 10px);
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .input-inline {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .input-inline label {
            width: 30%;
            font-weight: normal;
        }
        .input-inline input {
            width: 65%;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #e9ecef;
            text-align: center;
            font-size: 1.2em;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>평가 점수 확률 계산기</h1>
        <p>몬테카를로 시뮬레이션 기반으로 확률을 계산합니다.</p>
        
        <h2>확률 및 점수 설정</h2>
        <div class="input-group">
            <div class="input-inline">
                <label for="probEX">EX 확률 (%)</label>
                <input type="number" id="probEX" value="5" min="0" max="100">
                <label for="scoreEX">점수</label>
                <input type="number" id="scoreEX" value="3">
            </div>
            <div class="input-inline">
                <label for="probVG">VG 확률 (%)</label>
                <input type="number" id="probVG" value="15" min="0" max="100">
                <label for="scoreVG">점수</label>
                <input type="number" id="scoreVG" value="2">
            </div>
            <div class="input-inline">
                <label for="probGD">GD 확률 (%)</label>
                <input type="number" id="probGD" value="74" min="0" max="100" readonly>
                <label for="scoreGD">점수</label>
                <input type="number" id="scoreGD" value="1">
            </div>
            <div class="input-inline">
                <label for="probNI">NI 확률 (%)</label>
                <input type="number" id="probNI" value="5" min="0" max="100">
                <label for="scoreNI">점수</label>
                <input type="number" id="scoreNI" value="-1">
            </div>
            <div class="input-inline">
                <label for="probUN">UN 확률 (%)</label>
                <input type="number" id="probUN" value="1" min="0" max="100">
                <label for="scoreUN">점수</label>
                <input type="number" id="scoreUN" value="-2">
            </div>
        </div>
        
        <h2>계산 조건 설정</h2>
        <div class="input-group">
            <label for="years">누적 연도</label>
            <input type="number" id="years" value="11" min="1">
        </div>
        <div class="input-group">
            <label for="targetScore">목표 총점 (이상)</label>
            <input type="number" id="targetScore" value="12">
        </div>
        <div class="input-group">
            <label for="simulations">시뮬레이션 횟수 (정확도에 영향)</label>
            <input type="number" id="simulations" value="100000" min="1000">
        </div>

        <button onclick="calculateProbability()">확률 계산하기</button>
        
        <div id="result">
            <p>계산 결과가 여기에 표시됩니다.</p>
        </div>
    </div>

    <script>
        function updateGDProbability() {
            const probEX = parseFloat(document.getElementById('probEX').value) || 0;
            const probVG = parseFloat(document.getElementById('probVG').value) || 0;
            const probNI = parseFloat(document.getElementById('probNI').value) || 0;
            const probUN = parseFloat(document.getElementById('probUN').value) || 0;
            const probGD = 100 - (probEX + probVG + probNI + probUN);
            document.getElementById('probGD').value = probGD.toFixed(2);
        }

        document.getElementById('probEX').addEventListener('input', updateGDProbability);
        document.getElementById('probVG').addEventListener('input', updateGDProbability);
        document.getElementById('probNI').addEventListener('input', updateGDProbability);
        document.getElementById('probUN').addEventListener('input', updateGDProbability);

        function calculateProbability() {
            const probEX = parseFloat(document.getElementById('probEX').value) / 100;
            const scoreEX = parseFloat(document.getElementById('scoreEX').value);
            const probVG = parseFloat(document.getElementById('probVG').value) / 100;
            const scoreVG = parseFloat(document.getElementById('scoreVG').value);
            const probGD = parseFloat(document.getElementById('probGD').value) / 100;
            const scoreGD = parseFloat(document.getElementById('scoreGD').value);
            const probNI = parseFloat(document.getElementById('probNI').value) / 100;
            const scoreNI = parseFloat(document.getElementById('scoreNI').value);
            const probUN = parseFloat(document.getElementById('probUN').value) / 100;
            const scoreUN = parseFloat(document.getElementById('scoreUN').value);
            
            const years = parseInt(document.getElementById('years').value);
            const targetScore = parseInt(document.getElementById('targetScore').value);
            const simulations = parseInt(document.getElementById('simulations').value);

            if (probEX + probVG + probGD + probNI + probUN !== 1) {
                // GD 확률이 자동으로 계산되므로 이 조건은 대체로 충족되나, 혹시 모를 오차를 대비
                console.warn("확률 총합이 100%가 아닐 수 있습니다. GD 확률이 자동으로 조정됩니다.");
            }

            const grades = ['EX', 'VG', 'GD', 'NI', 'UN'];
            const probabilities = [probEX, probVG, probGD, probNI, probUN];
            const scores = [scoreEX, scoreVG, scoreGD, scoreNI, scoreUN];

            let successfulSimulations = 0;

            for (let i = 0; i < simulations; i++) {
                let totalScore = 0;
                for (let j = 0; j < years; j++) {
                    const random = Math.random();
                    let cumulativeProb = 0;
                    for (let k = 0; k < grades.length; k++) {
                        cumulativeProb += probabilities[k];
                        if (random < cumulativeProb) {
                            totalScore += scores[k];
                            break;
                        }
                    }
                }
                if (totalScore >= targetScore) {
                    successfulSimulations++;
                }
            }

            const probability = (successfulSimulations / simulations) * 100;
            document.getElementById('result').innerHTML = `<p><strong>${years}년 동안 ${targetScore}점 이상 취득할 확률:</strong></p><h2>${probability.toFixed(2)}%</h2>`;
        }

        // 페이지 로드 시 GD 확률 초기화
        window.onload = updateGDProbability;
    </script>
</body>
</html>
